USE [GestionHv]
GO
/****** Object:  StoredProcedure [dbo].[SP_CONSULTA_GENERAL]    Script Date: 29/10/2016 12:07:27 a.m. ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		Omar Manjarres Forero
-- Create date: 02/10/2016
-- Description:	Este query arroja os resultados de las busquedas por algun parametro de la hoja de vida
-- =============================================
ALTER PROCEDURE [dbo].[SP_CONSULTA_GENERAL]--'DIR','om','AREA','NOMBRES','IGUAL'
	@PARAMETRO VARCHAR(50),
	@PARAMETRO2 VARCHAR(50),
 	@VARIABLE VARCHAR(20),
	@VARIABLE2 VARCHAR(20),
	@SAL VARCHAR(50)
AS
BEGIN
	  
	IF @VARIABLE = 'IDENTIFICACION'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
		   FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA 
		   WHERE e.NUM_DOCUMENTO = @PARAMETRO 

    IF @VARIABLE = 'NOMBRES' and @VARIABLE2 = 'NINGUNA' or @VARIABLE = 'APELLIDOS' and @VARIABLE2 = 'NINGUNA'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
		   FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA 
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO) + '%' OR e.APELLIDOS  LIKE '%' + (@PARAMETRO) + '%' 
    IF @VARIABLE = 'AREA' and  @VARIABLE2 = 'NINGUNA'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
	       WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO) + '%' 
    IF @VARIABLE = 'SALARIO' and  @VARIABLE2 = 'NINGUNA' and @SAL = 'MAYOR'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
           WHERE c.SALARIO > @PARAMETRO
    IF @VARIABLE = 'SALARIO' and  @VARIABLE2 = 'NINGUNA' and @SAL = 'MENOR'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE c.SALARIO < @PARAMETRO
    IF @VARIABLE = 'SALARIO' and  @VARIABLE2 = 'NINGUNA' and @SAL = 'IGUAL'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE c.SALARIO = @PARAMETRO
   --SE EMPIEZA A BUSCAR CON DOBLE FILTRO
    IF @VARIABLE = 'NOMBRES' and @VARIABLE2 = 'SALARIO'  and @SAL = 'IGUAL'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO = @PARAMETRO2
    IF @VARIABLE2 = 'NOMBRES' and @VARIABLE = 'SALARIO'  and @SAL = 'IGUAL'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO = @PARAMETRO
    IF @VARIABLE = 'APELLIDOS' and @VARIABLE2 = 'SALARIO'  and @SAL = 'IGUAL'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO = @PARAMETRO2
    IF @VARIABLE2 = 'APELLIDOS' and @VARIABLE = 'SALARIO'  and @SAL = 'IGUAL'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO = @PARAMETRO
	--SALARIO Y NOMBRES MAYOR QUE
	 IF @VARIABLE = 'NOMBRES' and @VARIABLE2 = 'SALARIO'  and @SAL = 'MAYOR'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO > @PARAMETRO2
    IF @VARIABLE2 = 'NOMBRES' and @VARIABLE = 'SALARIO'  and @SAL = 'MAYOR'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO > @PARAMETRO
   -- APELLIDOS Y SALARIO MAYOR QUE
    IF @VARIABLE = 'APELLIDOS' and @VARIABLE2 = 'SALARIO'  and @SAL = 'MAYOR'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.APELLIDOS LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO > @PARAMETRO2
    IF @VARIABLE2 = 'APELLIDOS' and @VARIABLE = 'SALARIO'  and @SAL = 'MAYOR'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.APELLIDOS LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO > @PARAMETRO   
  -- NOMBRES APELLIDOS SALARIO MENOR QUE
  	 IF @VARIABLE = 'NOMBRES' and @VARIABLE2 = 'SALARIO'  and @SAL = 'MENOR'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO < @PARAMETRO2
    IF @VARIABLE2 = 'NOMBRES' and @VARIABLE = 'SALARIO'  and @SAL = 'MENOR'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.NOMBRES LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO < @PARAMETRO
   -- APELLIDOS Y SALARIO MAYOR QUE
    IF @VARIABLE = 'APELLIDOS' and @VARIABLE2 = 'SALARIO'  and @SAL = 'MENOR'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.APELLIDOS LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO < @PARAMETRO2
    IF @VARIABLE2 = 'APELLIDOS' and @VARIABLE = 'SALARIO'  and @SAL = 'MENOR'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE e.APELLIDOS LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO < @PARAMETRO
  
   -- NOMBRES Y AREA
    IF @VARIABLE = 'AREA' and @VARIABLE2 = 'NOMBRES'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
	       WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO) + '%' and e.NOMBRES LIKE '%' + (@PARAMETRO2) + '%'
    iF @VARIABLE2 = 'AREA' and @VARIABLE = 'NOMBRES'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
	       WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO2) + '%' and e.NOMBRES LIKE '%' + (@PARAMETRO) + '%'
   -- APELLIDOS Y AREA
    IF @VARIABLE = 'AREA' and @VARIABLE2 = 'APELLIDOS'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
	       WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO) + '%' and e.APELLIDOS LIKE '%' + (@PARAMETRO2) + '%'
    iF @VARIABLE2 = 'AREA' and @VARIABLE = 'APELLIDOS'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
	       WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO2) + '%' and e.APELLIDOS LIKE '%' + (@PARAMETRO) + '%'
   	
	
	
	-- AREAS Y SALARIO IGUAL
	IF @VARIABLE = 'AREA' and @VARIABLE2 = 'SALARIO'  and @SAL = 'IGUAL'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO = @PARAMETRO2
    IF @VARIABLE2 = 'AREA' and @VARIABLE = 'SALARIO'  and @SAL = 'IGUAL'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO = @PARAMETRO
	--AREAS Y SALARIOS MAYOR QUE
	 IF @VARIABLE = 'AREA' and @VARIABLE2 = 'SALARIO'  and @SAL = 'MAYOR'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO > @PARAMETRO2
     IF @VARIABLE2 = 'AREA' and @VARIABLE = 'SALARIO'  and @SAL = 'MAYOR'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO > @PARAMETRO
    --AREAS Y SALARIOS MENOR QUE
  	 IF @VARIABLE = 'AREA' and @VARIABLE2 = 'SALARIO'  and @SAL = 'MENOR'
	       SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO) + '%' and c.SALARIO < @PARAMETRO2
    IF @VARIABLE2 = 'AREA' and @VARIABLE = 'SALARIO'  and @SAL = 'MENOR'
		   SELECT e.NUM_DOCUMENTO, (e.NOMBRES + e.APELLIDOS) AS NOMBRES, a.DESCRIP_AREA, c.CARGO_ACTUAL,c.SALARIO 
           FROM EMPLEADO e INNER JOIN CONTRATO c ON E.NUM_DOCUMENTO = C.ID_CONTRATO INNER JOIN AREA a on a.ID_AREA = c.AREA
		   WHERE a.DESCRIP_AREA LIKE '%' + (@PARAMETRO2) + '%' and c.SALARIO < @PARAMETRO
END
